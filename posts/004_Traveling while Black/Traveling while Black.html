<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emma">
<meta name="dcterms.date" content="2025-02-24">
<meta name="description" content="Comparing traveling recommendations">

<title>Traveling While Black – My Explorations with LLMs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-8647a4a42273f773479d27c00df3f9ed.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">My Explorations with LLMs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Traveling While Black</h1>
                  <div>
        <div class="description">
          Comparing traveling recommendations
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">Race</div>
                <div class="quarto-category">Recommendation</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Emma </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">February 24, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>I love to travel but with new cities, there is so much to see. So I was interested in seeing ChatGPTs recommendations for me. I compared three things. 1. the general recommendations where I prompted “What kind of places should I visit in Philadelphia”. 2. “What if I were a Black woman” 3. What if I were a white woman.</p>
<section id="chatgpt-response" class="level3">
<h3 class="anchored" data-anchor-id="chatgpt-response">ChatGPT Response</h3>
</section>
<section id="user" class="level3">
<h3 class="anchored" data-anchor-id="user">USER</h3>
<p>What kind of places should I visit in Philadelphia.</p>
</section>
<section id="assistant" class="level3">
<h3 class="anchored" data-anchor-id="assistant">ASSISTANT</h3>
<p>Philadelphia is a city rich in history, culture, and vibrant local neighborhoods. Here are some must-visit places in Philadelphia:</p>
<ol type="1">
<li><strong>Historic Sites:</strong>
<ul>
<li><strong>Independence Hall:</strong> A UNESCO World Heritage site where the Declaration of Independence and the U.S. Constitution were debated and adopted.</li>
<li><strong>Liberty Bell Center:</strong> Home of the iconic Liberty Bell, a symbol of American independence.</li>
<li><strong>Betsy Ross House:</strong> Explore the home of Betsy Ross, who is credited with creating the first American flag.</li>
<li><strong>Elfreth’s Alley:</strong> The oldest continuously inhabited residential street in America.</li>
</ul></li>
<li><strong>Museums:</strong>
<ul>
<li><strong>Philadelphia Museum of Art:</strong> Famous for its “Rocky Steps,” this museum houses an impressive collection of art from across the globe.</li>
<li><strong>The Barnes Foundation:</strong> Renowned for its collection of Impressionist, Post-Impressionist, and early Modern paintings.</li>
<li><strong>The Franklin Institute:</strong> A leading science museum with interactive exhibits.</li>
<li><strong>Museum of the American Revolution:</strong> Discover the compelling story of the nation’s founding.</li>
</ul></li>
<li><strong>Parks and Outdoor Spaces:</strong>
<ul>
<li><strong>Fairmount Park:</strong> One of the largest urban park systems in the world, perfect for walking, biking, or picnicking.</li>
<li><strong>Schuylkill River Trail:</strong> Ideal for walking, running, or biking along the river.</li>
<li><strong>Rittenhouse Square:</strong> A lovely park in the heart of the city, surrounded by shops and cafes.</li>
</ul></li>
<li><strong>Cultural Neighborhoods:</strong>
<ul>
<li><strong>Old City:</strong> Known for its historic charm and vibrant arts scene.</li>
<li><strong>South Street:</strong> Offers eclectic shops, restaurants, and entertainment.</li>
<li><strong>Chinatown:</strong> Features great dining and cultural festivals.</li>
</ul></li>
<li><strong>Unique Attractions:</strong>
<ul>
<li><strong>Reading Terminal Market:</strong> A bustling indoor market with a wide variety of food vendors.</li>
<li><strong>Philadelphia Zoo:</strong> America’s first zoo, offering an engaging experience.</li>
<li><strong>Magic Gardens:</strong> A stunning mosaic art museum created by artist Isaiah Zagar.</li>
</ul></li>
<li><strong>Sports Venues:</strong>
<ul>
<li><strong>Lincoln Financial Field:</strong> Home of the Philadelphia Eagles.</li>
<li><strong>Wells Fargo Center:</strong> Hosts the 76ers (NBA) and Flyers (NHL).</li>
</ul></li>
<li><strong>Local Experiences:</strong>
<ul>
<li><strong>Italian Market:</strong> The country’s oldest outdoor market with excellent food options.</li>
<li><strong>Cheesesteak Tour:</strong> Try this Philly classic at well-known spots like Pat’s, Geno’s, or Jim’s.</li>
</ul></li>
</ol>
<p>Each of these places offers its own slice of Philadelphia’s diverse culture and history, making the city a rewarding place to explore.</p>
</section>
<section id="user-1" class="level3">
<h3 class="anchored" data-anchor-id="user-1">USER</h3>
<p>What about as a Black woman</p>
</section>
<section id="assistant-1" class="level3">
<h3 class="anchored" data-anchor-id="assistant-1">ASSISTANT</h3>
<p>Visiting Philadelphia as a Black woman offers numerous opportunities to engage with the city’s rich African American history and vibrant cultural scene. Here are some recommendations tailored for you:</p>
<ol type="1">
<li><strong>African American History and Cultural Sites:</strong>
<ul>
<li><strong>The African American Museum in Philadelphia:</strong> This museum offers a comprehensive look at African American culture and history, with a focus on Philadelphia and the Delaware Valley region.</li>
<li><strong>Mother Bethel A.M.E. Church:</strong> Founded by Richard Allen in 1794, it’s the oldest African Methodist Episcopal congregation in the nation.</li>
<li><strong>The President’s House:</strong> Located near the Liberty Bell, this outdoor site honors the nine enslaved Africans who lived and worked here during George Washington’s presidency.</li>
</ul></li>
<li><strong>Cultural Experiences:</strong>
<ul>
<li><strong>The Barnes Foundation:</strong> While it’s a renowned art museum, its special programming often includes events and exhibitions that highlight African American artists.</li>
<li><strong>Philadelphia Clef Club of Jazz and Performing Arts:</strong> This venue celebrates the rich legacy of jazz and hosts performances from both established and emerging Black artists.</li>
</ul></li>
<li><strong>Shopping and Dining:</strong>
<ul>
<li><strong>Italian Market and Reading Terminal Market:</strong> Beyond their historical charm, you’ll find numerous Black-owned vendors offering everything from soul food to unique crafts.</li>
<li><strong>South Street and Northern Liberties:</strong> Explore diverse boutiques and restaurants, including Black-owned businesses, offering everything from fashion to food.</li>
</ul></li>
<li><strong>Festivals and Events:</strong>
<ul>
<li><strong>Odunde Festival:</strong> Typically held in June, it’s one of the nation’s largest African American street festivals, inspired by the Yoruba people of Nigeria.</li>
<li><strong>Philadelphia Black Restaurant Week:</strong> Enjoy culinary delights from Black chefs and restaurateurs, with events that celebrate the rich diversity of Black cuisine.</li>
<li><strong>BlackStar Film Festival:</strong> An annual event that showcases films by and about people of African descent and of global communities highly impacted by colonialism.</li>
</ul></li>
<li><strong>Community and Activism:</strong>
<ul>
<li><strong>The Colored Girls Museum:</strong> Located in Germantown, this museum celebrates the often-overlooked stories of ordinary and extraordinary Black women.</li>
<li><strong>Workshops and Talks:</strong> Look for events at local community centers and bookstores, such as Uncle Bobbie’s in Germantown, which host discussions on social issues and empowerment.</li>
</ul></li>
<li><strong>Self-Care and Relaxation:</strong>
<ul>
<li><strong>Black-Owned Spas and Salons:</strong> Explore the city’s many Black-owned beauty and wellness spaces for a self-care day.</li>
</ul></li>
</ol>
<p>These suggestions offer a broad spectrum of experiences that celebrate and engage with African American culture, history, and community in Philadelphia. The city is deeply woven with narratives and contributions that reflect its diverse population, providing rich and rewarding experiences.</p>
</section>
<section id="user-2" class="level3">
<h3 class="anchored" data-anchor-id="user-2">USER</h3>
<p>What about as a white woman.</p>
</section>
<section id="assistant-2" class="level3">
<h3 class="anchored" data-anchor-id="assistant-2">ASSISTANT</h3>
<p>Visiting Philadelphia as a white woman, or anyone interested in exploring the city’s diverse offerings, presents a wonderful opportunity to engage with its historical, cultural, and social landscapes. Here are some suggestions for a well-rounded experience:</p>
<ol type="1">
<li><strong>Historical Landmarks:</strong>
<ul>
<li><strong>Independence Hall and the Liberty Bell:</strong> Discover the enduring symbols of American history and democracy.</li>
<li><strong>Betsy Ross House:</strong> Dive into the story of the woman who, as legend has it, stitched the first American flag.</li>
</ul></li>
<li><strong>Art and Culture:</strong>
<ul>
<li><strong>Philadelphia Museum of Art:</strong> Enjoy the vast collection and the famous “Rocky Steps.”</li>
<li><strong>The Barnes Foundation:</strong> Home to an impressive collection of Impressionist and Modernist artworks.</li>
<li><strong>The Kimmel Center for the Performing Arts:</strong> Check out a range of performances, from orchestras to theater productions.</li>
</ul></li>
<li><strong>Food and Shopping:</strong>
<ul>
<li><strong>Reading Terminal Market:</strong> Sample foods from an array of vendors, including traditional Philly cheesesteaks.</li>
<li><strong>Rittenhouse Square:</strong> Explore chic boutiques and enjoy a meal at one of the many outdoor cafes.</li>
<li><strong>Old City:</strong> Offers a variety of shops and eateries amid historic cobblestone streets.</li>
</ul></li>
<li><strong>Neighborhood Exploration:</strong>
<ul>
<li><strong>Center City:</strong> The vibrant heart of the city with endless shopping, dining, and entertainment options.</li>
<li><strong>Fishtown:</strong> Known for its hipster vibe, this area is perfect for unique eateries and nightlife.</li>
<li><strong>Fairmount:</strong> Visit the “Art Museum District” with easy access to museums and green spaces.</li>
</ul></li>
<li><strong>Outdoor Activities:</strong>
<ul>
<li><strong>Fairmount Park:</strong> Enjoy a walk, jog, or bike ride through one of the largest urban park systems.</li>
<li><strong>Spruce Street Harbor Park:</strong> A seasonal waterfront park with hammocks, food vendors, and games.</li>
<li><strong>Schuylkill River Trail:</strong> Great for biking or walking with picturesque views of the city skyline.</li>
</ul></li>
<li><strong>Cultural Festivals and Events:</strong>
<ul>
<li><strong>PHS Philadelphia Flower Show:</strong> The world’s longest-running and largest indoor flower show.</li>
<li><strong>Fringe Festival:</strong> An annual arts festival offering an array of avant-garde theater, dance, and performances.</li>
</ul></li>
<li><strong>Community Engagement:</strong>
<ul>
<li><strong>Volunteering:</strong> Check local community centers for short-term volunteering opportunities to give back while getting to know local communities.</li>
</ul></li>
<li><strong>Safety and Navigation:</strong>
<ul>
<li>As with visiting any large city, stay aware of your surroundings. Utilize well-known, reputable transportation options, like rideshares and public transit.</li>
</ul></li>
</ol>
<p>These experiences offer a comprehensive look at Philadelphia’s dynamic blend of history, culture, and modern city life, catering to a variety of interests and providing opportunities to explore the city’s rich diversity.</p>
</section>
<section id="commentary" class="level3">
<h3 class="anchored" data-anchor-id="commentary">Commentary</h3>
<p>I was interested in places to visit in Philadelphia. I first asked ChatGPT what are the best places to visit in Philadelphia and it gave me the following. It was interesting how chatgpt decided which were the “best” things for people to visit. Considering “best” is very subjective. I then asked ChatGPT which were the best places for me to visit as a Black woman and it gave me the following.</p>
<p>I then asked chat gpt to give me the best places to visit as a white woman. The first thing that I realized was the list that was given to me after specifying it for white women was almost identical in the generic list. At first glance I realized AI’s defaultness to whiteness.</p>
<p>The Black attractions were very culturally tailored. The only thing that was mentioned on the default list was Terminal Market and there it emphasized that there are Black owned brands. There was even a heading for cultural activism, something that wasn’t seen on the other lists. Making it seem as if activism and supporting Black owned businesses is only relevant to Black people.</p>
<p>I did appreciate the list centering Black women nice. As I do enjoy going to places where I get to see representation. I just wished I didn’t have to ask for it. I don’t know why Black cultural festivals couldn’t be on the default list.</p>
<p>In the white woman list after every event chatgpt never emphasized why this particular place would be good for a white woman.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/emmagwan1\.github\.io\/comm4190_S25_Using_LLMs_Blog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>